pkgname=attractplus-kms
pkgver=2.6.2
pkgrel=5
_commit=0feb181c33a13d55b526bff132ac69c56a1ef0b1
pkgdesc="A graphical front-end for command line emulators that hides the underlying operating system and is intended to be controlled with a joystick or gamepad."
arch=('any')
url="http://www.attractmode.org/"
license=('GPL3')
depends=('openal' 'ffmpeg' 'fontconfig' 'libarchive' 'curl' 'libva-mesa-driver' 'glu')
makedepends=('git' 'sfml-drm-static')
conflicts=('attractplus-git')
#source=("${pkgname}::git+https://github.com/oomek/attractplus.git#tag=${pkgver}")
source=("${pkgname}::git+https://github.com/oomek/attractplus.git#commit=${_commit}")
sha256sums=('SKIP')

build() {
	cd "${pkgname}"
	make prefix=/usr/local USE_DRM=1 STATIC=1 FE_HWACCEL_VAAPI=1
}

package() {
	cd "${pkgname}"
	install -Dm755 attractplus "${pkgdir}"/usr/local/bin/attractplus-kms
}

